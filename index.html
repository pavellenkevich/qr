<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>QR Generator</title>
  <meta name="description" content="Minimal QR code generator: SVG / PNG / JPG with style options" />
  <meta name="theme-color" content="#f2f2f2" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f3f3f3; --panel:#dfdfdf; --ink:#222; --muted:#8a8a8a; --ink2:#3b3b3b; --accent:#111; --white:#fff; --border:#e7e7e7;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans",Arial,sans-serif;background:var(--bg);color:var(--ink);}

    .app{max-width:1200px;margin:0 auto;padding:28px 28px 18px;}
    header h1{font-weight:900;letter-spacing:.2px;margin:0; font-size:44px; display:flex; align-items:flex-end; gap:12px}
    header h1 .light{font-weight:700;color:#6b6b6b}
    .tag{font-size:12px;color:#888;background:#e5e5e5;border-radius:4px;padding:2px 6px;transform:translateY(-6px);}
    .scribble{display:block;width:160px;height:6px;background:linear-gradient(90deg,#111,#111);border-radius:999px;transform:rotate(-6deg);margin:8px 0 0 8px;}

    .grid{display:grid;grid-template-columns:1fr 1fr;gap:28px;margin-top:26px}

    .left{padding:30px 22px 22px;background:transparent;border-radius:12px}
    .right{background:var(--panel);border-radius:8px;padding:22px;display:grid;grid-template-rows:1fr auto;}

    label.title{display:block;font-weight:600;margin:18px 0 8px}

    .input{width:100%;padding:16px 18px;border:1px solid var(--border);border-radius:6px;background:#ececec;color:#6f6f6f;font-weight:600}

    /* Tabs (underline swoosh) */
    .tabs{display:flex;gap:22px;align-items:center;}
    .tabs button{appearance:none;border:none;background:none;padding:0;cursor:pointer;font-weight:700;color:#7a7a7a}
    .tabs button.active{color:var(--ink)}
    .tabs button.active::after{content:"";display:block;height:6px;width:64px;background:#111;border-radius:999px;transform:translateY(8px) rotate(-6deg)}

    .btn{appearance:none;border:none;border-radius:6px;padding:20px 28px;font-weight:700;font-size:22px;cursor:pointer}
    .btn.primary{background:#222;color:#fff;width:320px;}
    .btn.secondary{background:#9a9a9a;color:#fff;width:320px;opacity:.6}
    .btn[disabled]{cursor:not-allowed;opacity:.5}

    .stage{display:grid;place-items:center}
    .paper{width:min(520px,80%);aspect-ratio:1/1;background:#fff;border-radius:2px;box-shadow:0 14px 30px rgba(0,0,0,.18);display:grid;place-items:center;overflow:hidden}
    .placeholder{color:#9b9b9b;font-weight:700}

    .bar{display:flex;gap:28px;align-items:flex-end;justify-content:space-between;margin-top:18px}
    .bar .group{display:grid;gap:10px}
    .bar .row{display:flex;gap:18px;align-items:center}
    .label{font-weight:700}
    .chips{display:flex;gap:22px}
    .chips button{appearance:none;border:none;background:none;padding:0;cursor:pointer;font-weight:800;color:#7a7a7a}
    .chips button.active{color:var(--ink)}
    .chips button.active::after{content:"";display:block;height:6px;width:48px;background:#111;border-radius:999px;transform:translateY(8px) rotate(-6deg)}

    .res{width:140px;padding:14px 14px;border:1px solid var(--border);border-radius:4px;background:#ececec;font-weight:700;color:#333;text-align:center}

    footer{font-size:12px;color:#9b9b9b;margin-top:18px}
    footer a{color:#6b6b6b;text-decoration:none;font-weight:700}

    @media (max-width:960px){
      .grid{grid-template-columns:1fr;}
      .btn.primary,.btn.secondary{width:100%}
      .stage .paper{width:100%}
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>
        <span>QR</span>
        <span>Generator</span>
        <span class="light">Reader</span>
        <span class="tag">Coming soon</span>
      </h1>
      <span class="scribble" aria-hidden="true"></span>
    </header>

    <div class="grid">
      <!-- LEFT -->
      <section class="left">
        <label class="title" for="data">Enter your text:</label>
        <input id="data" class="input" type="text" placeholder="https://" autocomplete="off" />

        <label class="title">Choose a style:</label>
        <div class="tabs" id="styleTabs" role="tablist" aria-label="Style">
          <button type="button" data-style="squares" class="active" role="tab" aria-selected="true">Squares</button>
          <button type="button" data-style="dots" role="tab" aria-selected="false">Circles</button>
          <button type="button" data-style="diamonds" role="tab" aria-selected="false">Rombs</button>
        </div>

        <div style="height:22px"></div>
        <button class="btn primary" id="genBtn">Generate</button>
      </section>

      <!-- RIGHT -->
      <section class="right">
        <div class="stage">
          <div class="paper" id="paper">
            <div class="placeholder">YOUR QR WILL BE HERE</div>
          </div>
        </div>

        <div class="bar">
          <div class="group">
            <div class="label">File type:</div>
            <div class="chips" id="typeChips" role="tablist" aria-label="File type">
              <button type="button" data-type="svg" class="active" role="tab" aria-selected="true">SVG</button>
              <button type="button" data-type="png" role="tab" aria-selected="false">PNG</button>
              <button type="button" data-type="jpg" role="tab" aria-selected="false">JPG</button>
            </div>
          </div>

          <div class="group">
            <div class="label">Resolution:</div>
            <div class="row">
              <input id="size" class="res" type="number" min="128" max="4096" step="1" value="1024" />
            </div>
          </div>

          <button class="btn secondary" id="dlBtn" disabled>Download</button>
        </div>
      </section>
    </div>

    <footer>
      Created by <a href="#" rel="noopener">Liankevich</a>  /  <a href="#" rel="noopener">Donate</a>
    </footer>
  </div>

  <!-- QR matrix lib -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>

  <script>
  ;(() => {
    // Elements
    const $ = (s) => document.querySelector(s)
    const paper = $('#paper')
    const dataEl = $('#data')
    const genBtn = $('#genBtn')
    const dlBtn = $('#dlBtn')
    const sizeEl = $('#size')

    // Tabs state
    let style = 'squares'
    let ftype = 'svg'

    const styleTabs = $('#styleTabs')
    const typeChips = $('#typeChips')

    styleTabs.addEventListener('click', (e) => {
      const btn = e.target.closest('button[data-style]')
      if (!btn) return
      styleTabs.querySelectorAll('button').forEach(b => { b.classList.remove('active'); b.setAttribute('aria-selected','false') })
      btn.classList.add('active'); btn.setAttribute('aria-selected','true')
      style = btn.dataset.style
    })

    typeChips.addEventListener('click', (e) => {
      const btn = e.target.closest('button[data-type]')
      if (!btn) return
      typeChips.querySelectorAll('button').forEach(b => { b.classList.remove('active'); b.setAttribute('aria-selected','false') })
      btn.classList.add('active'); btn.setAttribute('aria-selected','true')
      ftype = btn.dataset.type
      sizeEl.disabled = (ftype === 'svg')
    })

    let lastUrl = null, lastFmt = null, lastName = 'qr-code'
    function revoke(){ if(lastUrl){ URL.revokeObjectURL(lastUrl); lastUrl=null } }

    function buildQR(text){
      const qr = window.qrcode(0, 'M'); qr.addData(text); qr.make(); return qr
    }

    function renderCanvas(qr,targetSize){
      const modules = qr.getModuleCount(); const quiet=4
      const scale = Math.max(1, Math.floor(targetSize / (modules + 2*quiet)))
      const size = scale * (modules + 2*quiet)
      const c = document.createElement('canvas'); c.width=size; c.height=size
      const ctx = c.getContext('2d')
      ctx.fillStyle='#fff'; ctx.fillRect(0,0,size,size)
      ctx.fillStyle='#000'
      const off = scale*quiet
      if (style === 'dots'){
        const r = Math.floor(scale*0.5)
        for(let rIdx=0;rIdx<modules;rIdx++) for(let cIdx=0;cIdx<modules;cIdx++) if(qr.isDark(rIdx,cIdx)){
          const cx = off + cIdx*scale + scale/2, cy = off + rIdx*scale + scale/2
          ctx.beginPath(); ctx.arc(cx,cy,r,0,Math.PI*2); ctx.fill()
        }
      } else if (style === 'diamonds'){
        for(let rIdx=0;rIdx<modules;rIdx++) for(let cIdx=0;cIdx<modules;cIdx++) if(qr.isDark(rIdx,cIdx)){
          const x = off + cIdx*scale, y = off + rIdx*scale
          ctx.save(); ctx.translate(x+scale/2, y+scale/2); ctx.rotate(Math.PI/4)
          ctx.fillRect(-scale/2,-scale/2, scale, scale); ctx.restore()
        }
      } else {
        for(let rIdx=0;rIdx<modules;rIdx++) for(let cIdx=0;cIdx<modules;cIdx++) if(qr.isDark(rIdx,cIdx)){
          ctx.fillRect(off + cIdx*scale, off + rIdx*scale, scale, scale)
        }
      }
      return c
    }

    function renderSVG(qr){
      const modules = qr.getModuleCount(); const quiet=4; const cell=8
      const size = (modules + 2*quiet) * cell
      const xmlns='http://www.w3.org/2000/svg'
      const svg = document.createElementNS(xmlns,'svg')
      svg.setAttribute('viewBox',`0 0 ${size} ${size}`); svg.setAttribute('width',size); svg.setAttribute('height',size)
      const bg = document.createElementNS(xmlns,'rect'); bg.setAttribute('fill','#fff'); bg.setAttribute('width',size); bg.setAttribute('height',size); svg.appendChild(bg)
      const g = document.createElementNS(xmlns,'g'); g.setAttribute('fill','#000'); svg.appendChild(g)
      const off = quiet*cell
      for(let r=0;r<modules;r++) for(let c=0;c<modules;c++) if(qr.isDark(r,c)){
        const x = off + c*cell, y = off + r*cell
        if (style==='dots'){
          const circ = document.createElementNS(xmlns,'circle'); circ.setAttribute('cx', x+cell/2); circ.setAttribute('cy', y+cell/2); circ.setAttribute('r', Math.floor(cell*0.5)); g.appendChild(circ)
        } else if (style==='diamonds'){
          const gg = document.createElementNS(xmlns,'g'); gg.setAttribute('transform', `translate(${x+cell/2} ${y+cell/2}) rotate(45) translate(${-cell/2} ${-cell/2})`)
          const rect = document.createElementNS(xmlns,'rect'); rect.setAttribute('width',cell); rect.setAttribute('height',cell); gg.appendChild(rect); g.appendChild(gg)
        } else {
          const rect = document.createElementNS(xmlns,'rect'); rect.setAttribute('x',x); rect.setAttribute('y',y); rect.setAttribute('width',cell); rect.setAttribute('height',cell); g.appendChild(rect)
        }
      }
      return svg
    }

    function setPreview(node){ paper.innerHTML=''; paper.appendChild(node) }

    async function toBlobUrl(canvas, mime){
      return new Promise((resolve)=>{
        if (canvas.toBlob){ canvas.toBlob(b=>resolve(URL.createObjectURL(b)), mime, 0.92) }
        else { const dataUrl = canvas.toDataURL(mime,0.92); fetch(dataUrl).then(r=>r.blob()).then(b=> resolve(URL.createObjectURL(b))) }
      })
    }

    genBtn.addEventListener('click', async () => {
      const text = (dataEl.value||'').trim(); if(!text) return
      if (typeof window.qrcode !== 'function'){ alert('QR library not loaded yet, try again.'); return }
      revoke(); dlBtn.disabled = true
      const qr = buildQR(text)
      if (ftype === 'svg'){
        const svg = renderSVG(qr); setPreview(svg)
        const blob = new Blob([new XMLSerializer().serializeToString(svg)], {type:'image/svg+xml'})
        lastUrl = URL.createObjectURL(blob); lastFmt='svg'
      } else {
        const size = Math.min(Math.max(parseInt(sizeEl.value||'1024',10),128),4096)
        const canvas = renderCanvas(qr,size); setPreview(canvas)
        const mime = ftype==='jpg' ? 'image/jpeg' : 'image/png'
        lastUrl = await toBlobUrl(canvas, mime); lastFmt = ftype
      }
      dlBtn.disabled = false
    })

    dlBtn.addEventListener('click', ()=>{
      if(!lastUrl) return
      const a = document.createElement('a'); a.href=lastUrl; a.download=`qr-code.${lastFmt}`; document.body.appendChild(a); a.click(); a.remove()
    })

    // Keyboard: Enter on text => generate
    dataEl.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); genBtn.click() } })
  })()
  </script>
</body>
</html>
